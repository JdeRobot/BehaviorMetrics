---
title: Behavior Metrics tutorial using Tensoflow <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/2d/Tensorflow_logo.svg/1200px-Tensorflow_logo.svg.png" alt="TF logo" width="50"/> and PyTorch <img src="https://pytorch.org/assets/images/pytorch-logo.png" alt="Pytorch logo" width="50"/> 
layout: posts
permalink: /quick_start/tutorial/

collection: posts

classes: wide

sidebar:
  nav: "docs"
  
---

In this tutorial, you will train your first follow line brain for the F1 that can be run on Behavior Metrics.

**Step 1.** First of all, make sure you have Behavior Metrics installed, following the [installation section](/install/). You can try running the *explicit brain* that is
already included on Behavior Metrics brains folder. This brain is capable of finishing every circuit available for the project.

**Step 2.** All the deep learning brains with their code can be located at [Deep Learning Studio's repo](https://github.com/JdeRobot/DeepLearningStudio). 
For this tutorial, we will be using PilotNet architecture, a CNN based solution for self-driving cars. You can navigate to the previous repo to the
[Formula 1-Follow line folder](https://github.com/JdeRobot/DeepLearningStudio/tree/main/Formula1-FollowLine), where both implementations for pytorch and tensorflow are located. 

First, we will use tensorflow <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/2d/Tensorflow_logo.svg/1200px-Tensorflow_logo.svg.png" alt="TF logo" width="20"/> . 

1. Follow the step on that repo for generating a new deep learning model using tensorflow and PilotNet. On that repo you will find information about how to download the dataset
and how to train the model. Using the examples shown there should be fine for this tutorial (you can explore different combinations afterwards ðŸ˜„).

2. After training your first tensorflow model for the follow line problem, you will have a *.h5* file generated by the previous execution.

3. Take that *.h5* file and store it on *behavior_metrics/models/* creating a new folder *tensorflow_models*. 

4. We're almost ready to go. Modify the *DL-tensorflow.yml* file under *behavior_metrics/configs/* folder, changing the *Model:* '[your_model_name].h5' with your model name.

5. Execute Behavior Studio with the command

```
    python3 driver.py -c configs/DL-tensorflow.yml -g
```

and your done. Press the **PLAY** button shown on the GUI and the f1 should be running!

Second, we will use pytorch <img src="https://pytorch.org/assets/images/pytorch-logo.png" alt="Pytorch logo" width="50"/>. 

1. Follow step 1 of the above Tensorflow <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/2d/Tensorflow_logo.svg/1200px-Tensorflow_logo.svg.png" alt="TF logo" width="20"/>  tutorial.

2. After training your first pytorch model for the follow line problem, you will have a *.ckpt* file generated by the previous execution.

3. Take that *.ckpt* file and store it on *behavior_metrics/models/* creating a new folder *torch_models*. 

4. We're almost ready to go. Modify the *DL-torch.yml* file under *behavior_metrics/configs/* folder, changing the *Model:* '[your_model_name].ckpt' with your model name.

5. Execute Behavior Studio with the command

```
    python3 driver.py -c configs/DL-torch.yml -g
```

and your done. Press the **PLAY** button shown on the GUI and the f1 should be running!

**NOTE:** If you find any problem running this tutorial, create an issue on [Behavior Metrics repo](https://github.com/JdeRobot/BehaviorMetrics/issues/new) so we can help you.